 expected: []byte{0x1, 0x9, 0x0, 0xc, 0xb4, 0x2, 0x4, 0x0, 0x1, 0x22, 0x23, 0x24, 0x76, 0x87, 0x1, 0x88, 0x1, 0x99, 0x1, 0x0, 0x2, 0xc, 0x33, 0x2e, 0x32, 0x33, 0x33, 0x2e, 0x31, 0x34, 0x34, 0x2e, 0x35, 0x32, 0x1, 0x0, 0xd, 0x33, 0x2e, 0x32, 0x33, 0x33, 0x2e, 0x31, 0x34, 0x38, 0x2e, 0x31, 0x32, 0x30, 0x1, 0x38, 0x0, 0x0, 0x5, 0xd, 0x35, 0x32, 0x2e, 0x32, 0x31, 0x36, 0x2e, 0x37, 0x36, 0x2e, 0x31, 0x30, 0x38, 0x1, 0x16, 0xd, 0x33, 0x2e, 0x32, 0x33, 0x33, 0x2e, 0x31, 0x34, 0x38, 0x2e, 0x31, 0x31, 0x38, 0x1, 0x0, 0xd, 0x33, 0x34, 0x2e, 0x31, 0x32, 0x30, 0x2e, 0x31, 0x35, 0x2e, 0x31, 0x37, 0x33, 0x1, 0x75, 0xb, 0x35, 0x32, 0x2e, 0x32, 0x31, 0x37, 0x2e, 0x37, 0x39, 0x2e, 0x34, 0x2, 0x0, 0x0, 0xd, 0x33, 0x2e, 0x32, 0x33, 0x33, 0x2e, 0x31, 0x34, 0x37, 0x2e, 0x31, 0x39, 0x37, 0x1, 0x0, 0x1, 0xd, 0x33, 0x2e, 0x32, 0x33, 0x33, 0x2e, 0x31, 0x34, 0x37, 0x2e, 0x32, 0x30, 0x39, 0x1, 0x0, 0x0, 0x1, 0xc, 0x31, 0x37, 0x32, 0x2e, 0x32, 0x36, 0x2e, 0x34, 0x38, 0x2e, 0x31, 0x30, 0x1, 0xd3, 0x1, 0x3, 0xd, 0x33, 0x2e, 0x32, 0x33, 0x33, 0x2e, 0x31, 0x34, 0x37, 0x2e, 0x31, 0x39, 0x38, 0x1, 0x0, 0xd, 0x33, 0x34, 0x2e, 0x31, 0x30, 0x37, 0x2e, 0x31, 0x37, 0x32, 0x2e, 0x32, 0x33, 0x1, 0x57, 0xe, 0x33, 0x34, 0x2e, 0x31, 0x31, 0x37, 0x2e, 0x32, 0x31, 0x38, 0x2e, 0x32, 0x32, 0x37, 0x1, 0x99, 0x1, 0x0, 0x0, 0x0, 0x15, 0x70, 0x72, 0x6f, 0x63, 0x65, 0x73, 0x73, 0x2e, 0x64, 0x61, 0x74, 0x61, 0x64, 0x6f, 0x67, 0x68, 0x71, 0x2e, 0x63, 0x6f, 0x6d, 0x21, 0x65, 0x6c, 0x61, 0x73, 0x74, 0x69, 0x63, 0x6d, 0x61, 0x70, 0x72, 0x65, 0x64, 0x75, 0x63, 0x65, 0x2e, 0x73, 0x33, 0x2e, 0x61, 0x6d, 0x61, 0x7a, 0x6f, 0x6e, 0x61, 0x77, 0x73, 0x2e, 0x63, 0x6f, 0x6d, 0x1e, 0x36, 0x2d, 0x33, 0x31, 0x2d, 0x31, 0x2d, 0x61, 0x70, 0x70, 0x2e, 0x61, 0x67, 0x65, 0x6e, 0x74, 0x2e, 0x64, 0x61, 0x74, 0x61, 0x64, 0x6f, 0x67, 0x68, 0x71, 0x2e, 0x63, 0x6f, 0x6d, 0x1d, 0x36, 0x2d, 0x33, 0x31, 0x2d, 0x31, 0x2d, 0x61, 0x70, 0x70, 0x2e, 0x61, 0x67, 0x65, 0x6e, 0x74, 0x2e, 0x64, 0x61, 0x74, 0x61, 0x64, 0x6f, 0x67, 0x68, 0x71, 0x2e, 0x65, 0x75, 0x23, 0x61, 0x67, 0x65, 0x6e, 0x74, 0x2d, 0x68, 0x74, 0x74, 0x70, 0x2d, 0x69, 0x6e, 0x74, 0x61, 0x6b, 0x65, 0x2e, 0x6c, 0x6f, 0x67, 0x73, 0x2e, 0x64, 0x61, 0x74, 0x61, 0x64, 0x6f, 0x67, 0x68, 0x71, 0x2e, 0x65, 0x75, 0x14, 0x70, 0x72, 0x6f, 0x63, 0x65, 0x73, 0x73, 0x2e, 0x64, 0x61, 0x74, 0x61, 0x64, 0x6f, 0x67, 0x68, 0x71, 0x2e, 0x65, 0x75, 0x24, 0x61, 0x67, 0x65, 0x6e, 0x74, 0x2d, 0x68, 0x74, 0x74, 0x70, 0x2d, 0x69, 0x6e, 0x74, 0x61, 0x6b, 0x65, 0x2e, 0x6c, 0x6f, 0x67, 0x73, 0x2e, 0x64, 0x61, 0x74, 0x61, 0x64, 0x6f, 0x67, 0x68, 0x71, 0x2e, 0x63, 0x6f, 0x6d, 0x1c, 0x69, 0x70, 0x2d, 0x31, 0x37, 0x32, 0x2d, 0x32, 0x36, 0x2d, 0x34, 0x38, 0x2d, 0x31, 0x30, 0x2e, 0x65, 0x6d, 0x72, 0x2e, 0x70, 0x72, 0x6f, 0x64, 0x2e, 0x64, 0x6f, 0x67, 0x21, 0x61, 0x77, 0x73, 0x31, 0x35, 0x37, 0x2d, 0x6c, 0x6f, 0x67, 0x73, 0x2d, 0x70, 0x72, 0x6f, 0x64, 0x2e, 0x73, 0x33, 0x2e, 0x61, 0x6d, 0x61, 0x7a, 0x6f, 0x6e, 0x61, 0x77, 0x73, 0x2e, 0x63, 0x6f, 0x6d, 0x21, 0x64, 0x64, 0x2d, 0x65, 0x6d, 0x72, 0x2d, 0x6c, 0x6f, 0x67, 0x73, 0x2d, 0x70, 0x72, 0x6f, 0x64, 0x2e, 0x73, 0x33, 0x2e, 0x61, 0x6d, 0x61, 0x7a, 0x6f, 0x6e, 0x61, 0x77, 0x73, 0x2e, 0x63, 0x6f, 0x6d}
 actual  : []byte{0x1, 0x9, 0x0, 0xc, 0xcb, 0x1, 0x4, 0x0, 0x1, 0x21, 0x22, 0x23, 0x75, 0x86, 0x1, 0x87, 0x1, 0x97, 0x1, 0x0, 0x2, 0xd, 0x33, 0x2e, 0x32, 0x33, 0x33, 0x2e, 0x31, 0x34, 0x38, 0x2e, 0x31, 0x32, 0x30, 0x1, 0x0, 0xc, 0x33, 0x2e, 0x32, 0x33, 0x33, 0x2e, 0x31, 0x34, 0x34, 0x2e, 0x35, 0x32, 0x1, 0x1f, 0x0, 0x0, 0x5, 0xd, 0x35, 0x32, 0x2e, 0x32, 0x31, 0x36, 0x2e, 0x37, 0x36, 0x2e, 0x31, 0x30, 0x38, 0x1, 0x85, 0x1, 0xd, 0x33, 0x2e, 0x32, 0x33, 0x33, 0x2e, 0x31, 0x34, 0x38, 0x2e, 0x31, 0x31, 0x38, 0x1, 0x1f, 0xd, 0x33, 0x34, 0x2e, 0x31, 0x32, 0x30, 0x2e, 0x31, 0x35, 0x2e, 0x31, 0x37, 0x33, 0x1, 0xa7, 0x1, 0xb, 0x35, 0x32, 0x2e, 0x32, 0x31, 0x37, 0x2e, 0x37, 0x39, 0x2e, 0x34, 0x2, 0x1f, 0x1f, 0xd, 0x33, 0x2e, 0x32, 0x33, 0x33, 0x2e, 0x31, 0x34, 0x37, 0x2e, 0x31, 0x39, 0x37, 0x1, 0x1f, 0x1, 0xd, 0x33, 0x2e, 0x32, 0x33, 0x33, 0x2e, 0x31, 0x34, 0x37, 0x2e, 0x32, 0x30, 0x39, 0x1, 0x1f, 0x0, 0x1, 0xc, 0x31, 0x37, 0x32, 0x2e, 0x32, 0x36, 0x2e, 0x34, 0x38, 0x2e, 0x31, 0x30, 0x1, 0x68, 0x3, 0xd, 0x33, 0x2e, 0x32, 0x33, 0x33, 0x2e, 0x31, 0x34, 0x37, 0x2e, 0x31, 0x39, 0x38, 0x1, 0x1f, 0xd, 0x33, 0x34, 0x2e, 0x31, 0x30, 0x37, 0x2e, 0x31, 0x37, 0x32, 0x2e, 0x32, 0x33, 0x1, 0x35, 0xe, 0x33, 0x34, 0x2e, 0x31, 0x31, 0x37, 0x2e, 0x32, 0x31, 0x38, 0x2e, 0x32, 0x32, 0x37, 0x1, 0x53, 0x1e, 0x36, 0x2d, 0x33, 0x31, 0x2d, 0x31, 0x2d, 0x61, 0x70, 0x70, 0x2e, 0x61, 0x67, 0x65, 0x6e, 0x74, 0x2e, 0x64, 0x61, 0x74, 0x61, 0x64, 0x6f, 0x67, 0x68, 0x71, 0x2e, 0x63, 0x6f, 0x6d, 0x15, 0x70, 0x72, 0x6f, 0x63, 0x65, 0x73, 0x73, 0x2e, 0x64, 0x61, 0x74, 0x61, 0x64, 0x6f, 0x67, 0x68, 0x71, 0x2e, 0x63, 0x6f, 0x6d, 0x1d, 0x36, 0x2d, 0x33, 0x31, 0x2d, 0x31, 0x2d, 0x61, 0x70, 0x70, 0x2e, 0x61, 0x67, 0x65, 0x6e, 0x74, 0x2e, 0x64, 0x61, 0x74, 0x61, 0x64, 0x6f, 0x67, 0x68, 0x71, 0x2e, 0x65, 0x75, 0x14, 0x70, 0x72, 0x6f, 0x63, 0x65, 0x73, 0x73, 0x2e, 0x64, 0x61, 0x74, 0x61, 0x64, 0x6f, 0x67, 0x68, 0x71, 0x2e, 0x65, 0x75, 0x1c, 0x69, 0x70, 0x2d, 0x31, 0x37, 0x32, 0x2d, 0x32, 0x36, 0x2d, 0x34, 0x38, 0x2d, 0x31, 0x30, 0x2e, 0x65, 0x6d, 0x72, 0x2e, 0x70, 0x72, 0x6f, 0x64, 0x2e, 0x64, 0x6f, 0x67, 0x21, 0x65, 0x6c, 0x61, 0x73, 0x74, 0x69, 0x63, 0x6d, 0x61, 0x70, 0x72, 0x65, 0x64, 0x75, 0x63, 0x65, 0x2e, 0x73, 0x33, 0x2e, 0x61, 0x6d, 0x61, 0x7a, 0x6f, 0x6e, 0x61, 0x77, 0x73, 0x2e, 0x63, 0x6f, 0x6d, 0x23, 0x61, 0x67, 0x65, 0x6e, 0x74, 0x2d, 0x68, 0x74, 0x74, 0x70, 0x2d, 0x69, 0x6e, 0x74, 0x61, 0x6b, 0x65, 0x2e, 0x6c, 0x6f, 0x67, 0x73, 0x2e, 0x64, 0x61, 0x74, 0x61, 0x64, 0x6f, 0x67, 0x68, 0x71, 0x2e, 0x65, 0x75}

 map[
     172.26.48.10:names:"ip-172-26-48-10.emr.prod.dog"  
     3.233.144.52:names:"process.datadoghq.com"  
     3.233.147.197:names:"process.datadoghq.com"  
     3.233.147.198:names:"process.datadoghq.com"  
     3.233.147.209:names:"process.datadoghq.com"  
     3.233.148.118:names:"process.datadoghq.com"  
     3.233.148.120:names:"6-31-1-app.agent.datadoghq.com"  
     34.107.172.23:names:"6-31-1-app.agent.datadoghq.eu"  
     34.117.218.227:names:"process.datadoghq.eu"  
     34.120.15.173:names:"agent-http-intake.logs.datadoghq.eu"  
     52.216.76.108:names:"elasticmapreduce.s3.amazonaws.com"  
     52.217.79.4:names:"process.datadoghq.com" 
                       "process.datadoghq.com" ]

    //s := "01  // version
	//      0900 // number of buckets
	//      0c  // length of pos buffer
	//      b402  // length of name buffer
	//      04    // middle bucket position
	//      00    // first bucket position
	//      01    //
	//      22    // 34
	//      23    // 35
	//      24    // 36
	//      76    // 118
	//      87 01 // 135
	//      88 01 // 136
	//      99 01 // 153
	//      bucket block
	//      00    // (index 19) 0 entries in this bucket
    //      02    // (index 20) 2 entries in this bucket 
    //      0c    // (index 21) length of ip string (12) 
    3 . 2 3 3 . 1 4 4 . 5 2
    332e3233332e3134342e3532
    //      01    // (index 34) number of names (1)
    //      00    // (index 35) offset into name buffer (process.datadoghq.com)
    //      0d    // (index 36) length of ip string (13)
    3 . 2 3 3 . 1 4 8 . 1 2 0
    332e3233332e3134382e313230
    //      01    // (index 50) number of names (1) 
    //      38    // (index 51) offset into name buffer (6-31-1.app...)
    // start of third bucket expecting at position 34, actual 33
    //      00    // (index 52) (0 entries in this bucket
    //      00    // (index 53) (0 entries in this bucket) 
    //      05    // (index 54) (5 entries in this bucket)

    //      0d    // (index 55) (length of ip string) (13)
    5 2 . 2 1 6 . 7 6 . 1 0 8
    35322e3231362e37362e313038
    //      01    // number of names (1) 
    //      16    // offset into name buffer (elasticmapreduce... )
    //      0d    // length of ip string
    3 . 2 3 3 . 1 4 8 . 1 1 8 
    332e3233332e3134382e313138
    //      01    // number of names
    //      00    // offset into name buffer (0) (process...com) 
    //      0d    // length of ip string 
    3 4 . 1 2 0 . 1 5 . 1 7 3 
    33342e3132302e31352e313733
    //      01    // number of names
    //      75    // offset into name buffer (117) (intake) 
    //      0b    // length of ip string 
    5 2 . 2 1 7 . 7 9 . 4
    35322e3231372e37392e34
    //      02    // number of names (2) 
    //      00    // offset into name buffer (process.com)
    //      00    // offset into name buffer (process.com)
    //      0d    // length of ip string
    3 . 2 3 3 . 1 4 7 . 1 9 7 
    332e3233332e3134372e313937
    //      01     // number of names (1)
    //      00     // offset into name buffer (process.com)
    
    //      01     // number of entries in this bucket
    //      0d     // length of ip string
    3 . 2 3 3 . 1 4 7 . 2 0 9 
    332e3233332e3134372e323039
    //      01     // number of names
    //      00     // offset into name block (process...com)
    
    //      00     // number of entries in this bucket
    //      01     // number of entries in this bucket
    //      0c     // length of ip string
    1 7 2 . 2 6 . 4 8 . 1 0 
    3137322e32362e34382e3130
    //      01     // number of names
    //      d301   // offset into name block 211 (...emr.prod.dog) 
    
    //      03     // number of entries in this bucket
    //      0d     // length of ip string
    3 . 2 3 3 . 1 4 7 . 1 9 8 
    332e3233332e3134372e313938
    //      01     // number of names
    //      00     // offset into name buffer
    //      0d     // length of ip string
    3 4 . 1 0 7 . 1 7 2 . 2 3 
    33342e3130372e3137322e3233
    //      01     // number of names
    //      57     // offset into name buffer (agent.eu) 
    //      0e     // length of ip
    3 4 . 1 1 7 . 2 1 8 . 2 2 7
    33342e3131372e3231382e323237
    //      01     // number of names
    //      9901   // offset into name buffer (153) (process.eu)

    // what are these?
    00 00 00
    
    // begin name block
    15    // (21) length of first string (startpos 0) x
    p r o c e s s . d a t a d o g h q . c o m
    70726f636573732e64617461646f6768712e636f6d
    21    // (33) length of next string (startpos 22) x
    e l a s t i c m a p r e d u c e . s 3 . a m a z o n a w s . c o m
    656c61737469636d61707265647563652e73332e616d617a6f6e6177732e636f6d
    1e    // (30) length of next string (startpos 56) x
    6 - 3 1 - 1 - a p p . a g e n t . d a t a d o g h q . c o m
    362d33312d312d6170702e6167656e742e64617461646f6768712e636f6d
    1d    // (29) length of next string (startpos 87) x
    6 - 3 1 - 1 - a p p . a g e n t . d a t a d o g h q . e u
    362d33312d312d6170702e6167656e742e64617461646f6768712e6575
    23    // (35) length of next string (startpos 117) x
    a g e n t - h t t p - i n t a k e . l o g s . d a t a d o g h q . e u
    6167656e742d687474702d696e74616b652e6c6f67732e64617461646f6768712e6575
    14    // (20) length of next string (startpos 153) x
    p r o c e s s . d a t a d o g h q . e u
    70726f636573732e64617461646f6768712e6575
    24    // (36) length of next string (startpos 174)  <<-- unused
    a g e n t - h t t p - i n t a k e . l o g s . d a t a d o g h q . c o m 
    6167656e742d687474702d696e74616b652e6c6f67732e64617461646f6768712e636f6d
    1c    // (28) length of next string (startpos 211) x
    i p - 1 7 2 - 2 6 - 4 8 - 1 0 . e m r . p r o d . d o g 
    69702d3137322d32362d34382d31302e656d722e70726f642e646f67
    21    // (33) length of next string (startpost 240) << -- unused
    a w s 1 5 7 - l o g s - p r o d . s 3 . a m a z o n a w s . c o m
    6177733135372d6c6f67732d70726f642e73332e616d617a6f6e6177732e636f6d
    21    // (33) length of next string (startpos 274) << -- unused 
    d d - e m r - l o g s - p r o d . s 3 . a m a z o n a w s . c o m
    64642d656d722d6c6f67732d70726f642e73332e616d617a6f6e6177732e636f6d"                       